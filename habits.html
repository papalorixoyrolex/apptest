<!DOCTYPE html>
<html lang="uk">
<head>

  <link rel="icon" href="favicon.png" type="image/png">
  <link rel="manifest" href="manifest.json">
  <link rel="stylesheet" href="header_styles.css">

  <!-- –î–ª—è Apple (iPhone, iPad) -->
<link rel="apple-touch-icon" href="favicon.png">

<!-- –î–ª—è Android/Chrome –Ω–∞ –¥–æ–º–∞—à–Ω—å–æ–º—É –µ–∫—Ä–∞–Ω—ñ -->
<meta name="theme-color" content="#ffffff">

<meta name="mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-title" content="–ù–∞–∑–≤–∞–î–æ–¥–∞—Ç–∫—É">


  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
  
  <style>
    body {
      font-family: Arial, sans-serif;
      display: flex;
      flex-direction: column;
      align-items: center;
      padding: 30px 10px;
      min-height: 100vh;
    }

    #group-container {
      display: flex;
      flex-direction: column;
      gap: 20px;
      align-items: center;
      width: 100%;
      max-width: 400px;
      margin-bottom: 20px;
    }
    
    #task-container,
    #archived-container { 
      display: flex;
      flex-direction: column;
      gap: 20px;
      align-items: center;
      width: 100%;
      max-width: 400px;
      margin-bottom: 20px;
    }


.archived-group .title {
  font-weight: 700;
  font-size: 20px;
  color: #ffffff;
  text-shadow: none;
}


/* –¢–µ–∫—Å—Ç –∑–≤–∏—á–∫–∏ */
.archived-group div:nth-child(4) {
  font-size: 16px;
  line-height: 1.5;
  font-weight: bold;
  color: #ddd;
}

/* –î–∞—Ç–∞ */
.archived-group .date-created {
  font-size: 13px;
  color: #aaa;
  text-align: right;
  font-family: monospace;
  letter-spacing: 0.5px;
}


    .habit-group {
      border: 1px solid #ccc;
      border-radius: 12px;
      padding: 15px 20px;
      width: 100%;
      box-shadow: 0 2px 6px rgba(0,0,0,0.1);
      flex-direction: column;
      gap: 12px;
      position: relative;
      animation: fadeIn 0.3s ease;
    }

    .habit-group .title {
      color: #ffffff;
      font-weight: 700;
      font-size: 20px;
      outline: none;
      border: none;
      background: transparent;
      user-select: text;
    }

    .title {
      cursor: default;
    }

    .habit-input {
      width: 100%;
      padding: 8px 12px;
      font-size: 16px;
      border-radius: 8px;
      border: 1px solid #ccc;
      box-sizing: border-box;
    }

    .date-created {
      font-size: 14px;
      color: #666;
      user-select: none;
      text-align: right;
    }

    .add-block {
      margin: 20px 0 10px 0;
      width: auto;
      height: 50px;
      border: 2px dashed #999;
      border-radius: 12px;
      font-size: 36px;
      color: #444;
      display: flex;
      justify-content: center;
      align-items: center;
      cursor: pointer;
      user-select: none;
      transition: background-color 0.25s ease;
      padding: 0 30px;
      font-weight: 600;
      gap: 10px;
      background: #ddd;
    }

    .add-block:hover:not(.disabled) {
      background-color: #ccc;
    }

    .disabled {
      opacity: 0.5;
      pointer-events: none;
      cursor: default;
    }

    /* –ö–Ω–æ–ø–∫–∏ —É –±–ª–æ–∫–∞—Ö */
    .btn {
      position: absolute;
      top: 10px;
      font-size: 18px;
      user-select: none;
      cursor: pointer;
      background: transparent;
      border: none;
      padding: 0;
    }

    .btn-close {
      right: 10px;
      color: #a00;
    }

    .btn-save {
      right: 40px;
      color: #080;
    }

    .btn-archive-remove {
      right: 10px;
      color: #a00;
    }

    @keyframes fadeIn {
      from { opacity: 0; transform: scale(0.95); }
      to { opacity: 1; transform: scale(1); }
    }

    #confirm-toast {
  position: fixed;
  bottom: 30px;
  left: 50%;
  transform: translateX(-50%) scale(0.9);
  background: #333;
  color: white;
  padding: 16px 24px;
  border-radius: 10px;
  display: none;
  z-index: 9999;
  box-shadow: 0 4px 10px rgba(0,0,0,0.3);
  font-size: 16px;
  max-width: 90%;
  text-align: center;
  transition: opacity 0.3s ease, transform 0.3s ease;
}

#confirm-toast button {
  margin-top: 12px;
  background: #c62828;
  border: none;
  color: white;
  padding: 6px 16px;
  border-radius: 6px;
  cursor: pointer;
  font-weight: bold;
  font-size: 15px;
}

  </style>
</head>
<body>

  <div class="nav-bar">
    <button onclick="location.href='index.html'"><div class="icon">‚úçÔ∏è</div><div class="label">–ó–∞–ø–∏—Å–∏</div></button>
    <button onclick="location.href='task.html'"><div class="icon">üìú</div><div class="label">–¶—ñ–ª—ñ—ñ</div></button>
    <button onclick="location.href='habits.html'"><div class="icon">üìÖ</div><div class="label">–ó–≤–∏—á–∫–∏</div></button>
    <button onclick="location.href='history.html'"><div class="icon">üìñ</div><div class="label">–Ü—Å—Ç–æ—Ä—ñ—è</div></button>
  </div>

  <div id="group-container">
    <!-- –¢—É—Ç –∞–∫—Ç–∏–≤–Ω—ñ –±–ª–æ–∫–∏ –∑–≤–∏—á–æ–∫ -->
  </div>

  <h1 id="entry-heading">–î–æ–¥–∞—Ç–∏ –∑–≤–∏—á–∫—É +</h1>

  <div id="archived-container">
    <!-- –¢—É—Ç –∑–±–µ—Ä–µ–∂–µ–Ω—ñ, –∞—Ä—Ö—ñ–≤–æ–≤–∞–Ω—ñ –±–ª–æ–∫–∏ -->
  </div>

<script>
  const STORAGE_KEY = 'habitBlocks';
  const container = document.getElementById('group-container');
  const addBtn = document.getElementById('entry-heading');
  const archivedContainer = document.getElementById('archived-container');

  function saveAllBlocks() {
    const activeData = [...container.querySelectorAll('.habit-group')].map(block => ({
      title: block.querySelector('.title').value,
      habit: block.querySelector('.habit-input').value,
      date: block.querySelector('.date-created').textContent.replace('–°—Ç–≤–æ—Ä–µ–Ω–æ: ', '')
    }));

    const archivedData = [...archivedContainer.querySelectorAll('.archived-group')].map(block => ({
      title: block.querySelector('.title').textContent,
      habit: block.querySelector('div:nth-child(4)').textContent,
      date: block.querySelector('.date-created').textContent.replace('–°—Ç–≤–æ—Ä–µ–Ω–æ: ', '')
    }));

    localStorage.setItem(STORAGE_KEY, JSON.stringify({ active: activeData, archived: archivedData }));
  }

  function loadBlocksFromLocalStorage() {
    const data = JSON.parse(localStorage.getItem(STORAGE_KEY) || '{"active":[],"archived":[]}');

    container.innerHTML = '';
    archivedContainer.innerHTML = '';

    data.active.forEach(item => {
      const block = createHabitBlock(item.title, item.habit, item.date);
      container.appendChild(block);
    });

    data.archived.forEach(item => {
      const block = createArchivedBlock(item.title, item.habit, item.date);
      archivedContainer.appendChild(block);
    });

    updateAddButtonState();
  }

  function updateAddButtonState() {
    addBtn.classList.toggle('disabled', container.children.length >= 3);
  }

  function createHabitBlock(titleVal = '', habitVal = '', customDate = null) {
    const now = new Date();
    const formattedDate = customDate || now.toLocaleDateString('uk-UA', {
      year: 'numeric',
      month: '2-digit',
      day: '2-digit'
    });

    const block = document.createElement('div');
    block.className = 'habit-group';

    const closeBtn = document.createElement('button');
    closeBtn.textContent = '‚ùå';
    closeBtn.className = 'btn btn-close';
    closeBtn.onclick = () => {
      block.remove();
      saveAllBlocks();
      updateAddButtonState();
    };

    const saveBtn = document.createElement('button');
    saveBtn.textContent = '‚úÖ';
    saveBtn.className = 'btn btn-save';
    saveBtn.onclick = () => {
      archiveBlock(block);
    };

    const title = document.createElement('input');
    title.className = 'title';
    title.placeholder = '–ù–∞–∑–≤–∞ –∑–≤–∏—á–∫–∏';
    title.maxLength = 50;
    title.value = titleVal;

    const habitInput = document.createElement('input');
    habitInput.className = 'habit-input';
    habitInput.placeholder = '–í–≤–µ–¥—ñ—Ç—å –∑–≤–∏—á–∫—É (–¥–æ 100 —Å–∏–º–≤–æ–ª—ñ–≤)';
    habitInput.maxLength = 180;
    habitInput.value = habitVal;

    const dateDiv = document.createElement('div');
    dateDiv.className = 'date-created';
    dateDiv.textContent = `–°—Ç–≤–æ—Ä–µ–Ω–æ: ${formattedDate}`;

    block.append(closeBtn, saveBtn, title, document.createElement('hr'), habitInput, document.createElement('hr'), dateDiv);

    [title, habitInput].forEach(el => el.addEventListener('input', saveAllBlocks));

    return block;
  }

  function createArchivedBlock(titleVal, habitVal, dateVal) {
    const block = document.createElement('div');
    block.className = 'archived-group';

    const closeBtn = document.createElement('button');
    closeBtn.textContent = '‚ùå';
    closeBtn.className = 'btn btn-archive-remove';
    closeBtn.onclick = () => {
    showConfirmToast(titleVal, dateVal, () => {
    block.remove();
    saveAllBlocks();
  });
};

    const title = document.createElement('div');
    title.className = 'title';
    title.textContent = titleVal;

    const habitText = document.createElement('div');
    habitText.textContent = habitVal;

    const dateDiv = document.createElement('div');
    dateDiv.className = 'date-created';
    dateDiv.textContent = `–°—Ç–≤–æ—Ä–µ–Ω–æ: ${dateVal}`;

    block.append(closeBtn, title, document.createElement('hr'), habitText, document.createElement('hr'), dateDiv);
    return block;
  }

  function archiveBlock(block) {
    const title = block.querySelector('.title').value.trim();
    const habit = block.querySelector('.habit-input').value.trim();
    const date = block.querySelector('.date-created').textContent.replace('–°—Ç–≤–æ—Ä–µ–Ω–æ: ', '');

    if (!title && !habit) {
      alert('–ù–µ–º–æ–∂–ª–∏–≤–æ –∑–±–µ—Ä–µ–≥—Ç–∏ –ø—É—Å—Ç—É –∑–≤–∏—á–∫—É.');
      return;
    }

    const archivedBlock = createArchivedBlock(title, habit, date);
    archivedContainer.appendChild(archivedBlock);
    block.remove();
    saveAllBlocks();
    updateAddButtonState();
  }

  addBtn.addEventListener('click', () => {
    if (container.children.length >= 3) {
      alert('–ú–æ–∂–Ω–∞ –¥–æ–¥–∞—Ç–∏ –º–∞–∫—Å–∏–º—É–º 3 –∑–≤–∏—á–∫–∏.');
      return;
    }
    const newBlock = createHabitBlock();
    container.appendChild(newBlock);
    saveAllBlocks();
    updateAddButtonState();
  });

  window.addEventListener('DOMContentLoaded', loadBlocksFromLocalStorage);

  let toastTimeout = null;

function showConfirmToast(title, date, onConfirm) {
  const toast = document.getElementById('confirm-toast');
  const message = document.getElementById('confirm-message');
  const confirmBtn = document.getElementById('confirm-delete');

  message.textContent = `–í–∏ —Å–ø—Ä–∞–≤–¥—ñ –±–∞–∂–∞—î—Ç–µ –≤–∏–¥–∞–ª–∏—Ç–∏ "${title}" –≤—ñ–¥ ${date}?`;

  // –û—á–∏—Å—Ç–∏—Ç–∏ –ø–æ–ø–µ—Ä–µ–¥–Ω—ñ–π –æ–±—Ä–æ–±–Ω–∏–∫
  const newBtn = confirmBtn.cloneNode(true);
  confirmBtn.parentNode.replaceChild(newBtn, confirmBtn);

  newBtn.onclick = () => {
    hideConfirmToast();
    onConfirm();
  };

  toast.style.display = 'block';
  toast.style.opacity = '1';
  toast.style.transform = 'translateX(-50%) scale(1)';

  clearTimeout(toastTimeout);
  toastTimeout = setTimeout(() => {
    hideConfirmToast();
  }, 5000);
}

function hideConfirmToast() {
  const toast = document.getElementById('confirm-toast');
  toast.style.opacity = '0';
  toast.style.transform = 'translateX(-50%) scale(0.9)';
  setTimeout(() => toast.style.display = 'none', 300);
}

</script>

<div id="confirm-toast">
  <div id="confirm-message">–í–∏ —Å–ø—Ä–∞–≤–¥—ñ –±–∞–∂–∞—î—Ç–µ –≤–∏–¥–∞–ª–∏—Ç–∏?</div>
  <button id="confirm-delete">–¢–∞–∫</button>
</div>

<script src="allfiles.js" defer></script>
</body>

</html>
