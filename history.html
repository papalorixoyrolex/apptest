<!DOCTYPE html>
<html lang="uk">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">

  <title>testisquitcc</title>

  <link rel="stylesheet" href="header_styles.css">
  <link rel="icon" href="favicon.png" type="image/png">
  <link rel="apple-touch-icon" href="favicon.png">
  <meta name="theme-color" content="#ffffff">
  <meta name="mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-title" content="–ù–∞–∑–≤–∞–î–æ–¥–∞—Ç–∫—É">
  <link rel="manifest" href="manifest.json">
  <style>
    .entry-card {
  background: var(--bg-lightest);
  border: 1px solid var(--border-default);
  border-radius: var(--radius);
  padding: 16px;
  margin: 16px auto;
  max-width: 360px;
  box-shadow: var(--shadow);
  transition: transform 0.2s ease, box-shadow 0.2s ease;
}

.entry-card:hover {
  transform: scale(1.02);
  box-shadow: 0 6px 16px rgba(0,0,0,0.5);
}

    .entry-card .entry-full {
      display: none;
      margin-top: 10px;
    }
    .entry-card.expanded .entry-full {
      display: block;
    }
    .toggle-btn, .hide-btn, .delete-btn {
      cursor: pointer;
      margin-left: 8px;
    }
    .hide-btn {
      display: none;
    }
    .entry-card.expanded .toggle-btn {
      display: none;
    }
    .entry-card.expanded .hide-btn {
      display: inline-block;
    }

    .toggle-btn, .hide-btn {
  background-color: var(--bg-lightest);
  color: var(--text-strong);
  border: 1px solid var(--input-border);
  border-radius: 8px;
  padding: 6px 12px;
  font-weight: 600;
  font-size: 14px;
  transition: background-color 0.2s ease, transform 0.2s ease;
  box-shadow: var(--shadow);
}

.toggle-btn:hover,
.hide-btn:hover {
  background-color: #3a3a3a; /* —Ç—Ä–æ—Ö–∏ —Å–≤—ñ—Ç–ª—ñ—à–∏–π –≤–∞—Ä—ñ–∞–Ω—Ç */
  transform: scale(1.05);
}


    .date-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      font-weight: bold;
      color: var(--text-main);
      font-size: 16px;
      margin-bottom: 8px;
    }
    .response-item {
      padding: 6px 0;
      border-top: 1px solid #eee;
      display: flex;
      justify-content: space-between;
      align-items: flex-start;
    }
    .response-item:first-child {
      border-top: none;
    }
    .response-item p {
      margin: 4px 0 0;
      flex: 1;
    }
    .meta-controls {
      display: flex;
      align-items: center;
      gap: 6px;
      margin-left: 10px;
    }
  </style>
</head>
<body>
<div class="nav-bar">
    <button data-page="index.html" onclick="location.href='index.html'">
      <div class="icon">‚úçÔ∏è</div>
      <div class="label">–ó–∞–ø–∏—Å–∏</div>
    </button>
    <button data-page="task.html" onclick="location.href='task.html'">
      <div class="icon">üìú</div>
      <div class="label">–¶—ñ–ª—ñ</div>
    </button>
    <button data-page="habits.html" onclick="location.href='habits.html'">
      <div class="icon">üìÖ</div>
      <div class="label">–ó–≤–∏—á–∫–∏</div>
    </button>
    <button data-page="history.html" onclick="location.href='history.html'">
      <div class="icon">üìñ</div>
      <div class="label">–Ü—Å—Ç–æ—Ä—ñ—è</div>
    </button>
  </div>

  <h1 id="entry-heading"><a href="index.html" style="all: unset; cursor: pointer;">–î–æ–¥–∞—Ç–∏ –∑–∞–ø–∏—Å ‚úçÔ∏è</a></h1>


  <div id="clear-history-container" onclick="clearEntries()">–û—á–∏—Å—Ç–∏—Ç–∏ —ñ—Å—Ç–æ—Ä—ñ—é üóëÔ∏è</div>

  <div id="empty-message" style="display:none; text-align:center; margin-top:100px; color:#666; font-style:italic;">
    –Ü—Å—Ç–æ—Ä—ñ—è –∑–∞–ø–∏—Å—ñ–≤ –ø–æ—Ä–æ–∂–Ω—è.
  </div>
  <div id="entries-container"></div>

  <script>
      function showEntries() {
      const container = document.getElementById('entries-container');
      const emptyMsg = document.getElementById('empty-message');
      const clearBtn = document.getElementById('clear-history-container');
      container.innerHTML = '';
      const log = JSON.parse(localStorage.getItem('moodLog') || '[]');
      if (!log.length) {
        emptyMsg.style.display = 'block';
        clearBtn.style.display = 'none';
        return;
      }
      emptyMsg.style.display = 'none';
      clearBtn.style.display = 'block';

      const grouped = {};
      log.forEach((entry, dayIndex) => {
        const date = entry.date;
        if (!grouped[date]) grouped[date] = [];
        entry.responses.forEach((resp, respIndex) => {
          grouped[date].push({ dayIndex, respIndex, resp });
        });
      });

      Object.keys(grouped).forEach(date => {
        const items = grouped[date];
        const card = document.createElement('div');
        card.className = 'entry-card';

        const header = document.createElement('div');
        header.className = 'date-header';
        const dateSpan = document.createElement('span');
        dateSpan.textContent = date;
        const btnContainer = document.createElement('div');
        const toggleBtn = document.createElement('button');
        toggleBtn.className = 'toggle-btn';
        toggleBtn.textContent = '–ü—ñ–¥–≥–ª—è–Ω—É—Ç–∏ üëÄ';
        const hideBtn = document.createElement('button');
        hideBtn.className = 'hide-btn';
        hideBtn.textContent = '–°—Ö–æ–≤–∞—Ç–∏';
        btnContainer.append(toggleBtn, hideBtn);
        header.append(dateSpan, btnContainer);

        const fullDiv = document.createElement('div');
        fullDiv.className = 'entry-full';

        items.forEach(item => {
          const { dayIndex, respIndex, resp } = item;
          const itemDiv = document.createElement('div');
          itemDiv.className = 'response-item';

          const textP = document.createElement('p');
          textP.textContent = resp.text + (resp.emoji || '');

          const controlsDiv = document.createElement('div');
          controlsDiv.className = 'meta-controls';

          const timeSpan = document.createElement('span');
          timeSpan.textContent = resp.time || '';

          const delBtn = document.createElement('button');
          delBtn.className = 'delete-btn';
          delBtn.textContent = '‚ùå';
          delBtn.title = '–í–∏–¥–∞–ª–∏—Ç–∏ –∑–∞–ø–∏—Å';

          controlsDiv.append(timeSpan, delBtn);
          itemDiv.append(textP, controlsDiv);
          fullDiv.appendChild(itemDiv);

          delBtn.onclick = () => deleteSingleResponse(dayIndex, respIndex);
        });

        card.append(header, fullDiv);
        container.appendChild(card);

        toggleBtn.onclick = () => card.classList.add('expanded');
        hideBtn.onclick = () => card.classList.remove('expanded');
      });
    }

    function deleteSingleResponse(dayIndex, responseIndex) {
      if (!confirm('–í–∏–¥–∞–ª–∏—Ç–∏ —Ü–µ–π –∑–∞–ø–∏—Å?')) return;
      const log = JSON.parse(localStorage.getItem('moodLog') || '[]');
      log[dayIndex].responses.splice(responseIndex, 1);
      if (!log[dayIndex].responses.length) log.splice(dayIndex, 1);
      localStorage.setItem('moodLog', JSON.stringify(log));
      showEntries();
    }

    function clearEntries() {
      const log = JSON.parse(localStorage.getItem('moodLog') || '[]');
      if (!log.length) return alert('–ù–µ–º–∞—î –∑–∞–ø–∏—Å—ñ–≤ –¥–ª—è –≤–∏–¥–∞–ª–µ–Ω–Ω—è');
        showConfirmToast('–í–∏–¥–∞–ª–∏—Ç–∏ –≤—Å—é —ñ—Å—Ç–æ—Ä—ñ—é?', () => {
        localStorage.removeItem('moodLog');
        showEntries();
      });

    }

    showEntries();
  </script>
  <div id="toast-container"></div>
<script src="swipe-nav.js"></script>
</body>
</html>
