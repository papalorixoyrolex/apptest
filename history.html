  <!DOCTYPE html>
  <html lang="uk">
  <head>
      <link rel="stylesheet" href="header_styles.css">
      <link rel="icon" href="favicon.png" type="image/png">
      <link rel="apple-touch-icon" href="favicon.png">
      <meta name="theme-color" content="#ffffff">
      <meta name="mobile-web-app-capable" content="yes">
      <meta name="apple-mobile-web-app-capable" content="yes">
      <meta name="apple-mobile-web-app-title" content="–ù–∞–∑–≤–∞–î–æ–¥–∞—Ç–∫—É">

      <meta charset="UTF-8">
      <meta name="viewport" content="width=device-width, initial-scale=1.0">

      <link rel="manifest" href="manifest.json">
      <title>–Ü—Å—Ç–æ—Ä—ñ—è</title>
    

    <style>
      h1 {
        font-size: 24px;
        margin-bottom: 20px;
      }

      ul {
        list-style: none;
        padding: 0;
        max-width: 600px;
        width: 100%;
      }

      li {
        position: relative;
        max-width: 80%;
        margin-bottom: 10px;
        padding: 10px 40px 10px 10px;
        border-left: 5px solid #aaa;
        border-radius: 6px;
        white-space: pre-wrap;
        position: relative;
        display: flex;
        justify-content: space-between;
        align-items: flex-start;
        gap: 12px;
      }

      .delete-btn {
        position: absolute;
        top: 0px;
        right: -18%;
        color: white;
        border: none;
        padding: 4px 8px;
        font-size: 14px;
        border-radius: 4px;
        cursor: pointer;
      }

      a {
        margin-top: 20px;
        text-decoration: none;
        color: white;
        padding: 10px 20px;
        border-radius: 8px;
      }

    .history-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    gap: 10px;
  }

  /* –°—Ç–∏–ª—å –∑–∞–≥–æ–ª–æ–≤–∫–∞ */
  .history-header h1 {
    margin: 0;
    font-size: 24px;
  }

  /* –ö–æ–Ω—Ç–µ–π–Ω–µ—Ä-–∫–Ω–æ–ø–∫–∞, —â–æ —Å—Ç–≤–æ—Ä—é—î —Ä–∞–º–∫—É —ñ —Ç—ñ–Ω—å, –∞–ª–µ –Ω–µ –∫–ª—ñ–∫–∞–±–µ–ª—å–Ω–∞ */
  .clear-btn-container {
    display: inline-flex;
    align-items: center;
    padding: 5px 18px;
    border: 2px solid #e0e0e0;
    border-radius: 12px;
    box-shadow: 0 2px 6px rgba(0,0,0,0.1);
    
    /* –ë—ñ–ª–æ-–º–æ–ª–æ—á–Ω–∏–π –≥—Ä–∞–¥—ñ—î–Ω—Ç */
    background: linear-gradient(135deg, #f9f9f9 0%, #f0ece6 100%);
    
    user-select: none;
    pointer-events: none; /* –±–ª–æ–∫—É—î –∫–ª—ñ–∫–∏ –Ω–∞ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä */
    transition: box-shadow 0.3s ease;
  }


  /* –ü—Ä–∏ –Ω–∞–≤–µ–¥–µ–Ω–Ω—ñ –ª–µ–≥–∫–∞ "–≥–ª–∏–±–∏–Ω–∞" */
  .clear-btn-container:hover {
    box-shadow: 0 4px 10px rgba(0,0,0,0.15);
  }

  /* –í–ª–∞—Å–Ω–µ –∫–Ω–æ–ø–∫–∞ –≤–∏–¥–∞–ª—è—Ç–∏ */
  .clear-btn {
    pointer-events: auto; /* –¥–æ–∑–≤–æ–ª—è—î –∫–ª—ñ–∫–∏ –≤—Å–µ—Ä–µ–¥–∏–Ω—ñ */
    background: #ff4d4d;
    border: none;
    border-radius: 8px;
    color: white;
    font-size: 20px;
    width: 38px;
    height: 38px;
    cursor: pointer;
    display: flex;
    align-items: center;
    justify-content: center;
    transition: background-color 0.3s ease;
  }

  .clear-btn:hover {
    background: #e60000;
  }


  .clear-btn {
    background: #f44336;
    color: white;
    border: none;
    border-radius: 8px;
    padding: 8px 14px;
    font-size: 18px;
    cursor: pointer;
    transition: background-color 0.3s ease;
  }

  .clear-btn:hover {
    background: #c62828;
  }


  .toast {
    visibility: hidden;
    min-width: 200px;
    background-color: #333;
    color: #fff;
    text-align: center;
    border-radius: 6px;
    padding: 12px 18px;
    position: fixed;
    z-index: 10000;
    left: 50%;
    bottom: 30px;
    transform: translateX(-50%);
    font-size: 16px;
    opacity: 0;
    transition: opacity 0.5s ease, bottom 0.5s ease;
  }

  .toast.show {
    visibility: visible;
    opacity: 1;
    bottom: 50px;
  }

    </style>

    
  </head>
  <body>

  <div id="undo-toast" style="
    position: fixed;
    bottom: 30px;
    left: 50%;
    transform: translateX(-50%) scale(0.9);
    background: #333;
    color: white;
    padding: 14px 24px;
    border-radius: 8px;
    display: none;
    z-index: 9999;
    box-shadow: 0 4px 10px rgba(0,0,0,0.3);
    transition: opacity 0.3s ease, transform 0.3s ease;">
    <span id="undo-text">–í–∞—à–∞ —ñ—Å—Ç–æ—Ä—ñ—è –æ—á–∏—â—É—î—Ç—Å—è. </span>
    <button onclick="undoClear()" style="
      margin-left: 20px;
      background: crimson;
      border: none;
      color: white;
      padding: 6px 14px;
      border-radius: 6px;
      cursor: pointer;
    ">–°–∫–∞—Å—É–≤–∞—Ç–∏</button>
  </div>



  <div class="nav-bar">
    <button onclick="location.href='index.html'"><div class="icon">‚úçÔ∏è</div><div class="label">–ó–∞–ø–∏—Å–∏</div></button>
    <button onclick="location.href='task.html'"><div class="icon">üìú</div><div class="label">–¶—ñ–ª—ñ</div></button>
    <button onclick="location.href='habits.html'"><div class="icon">üìÖ</div><div class="label">–ó–≤–∏—á–∫–∏</div></button>
    <button onclick="location.href='history.html'"><div class="icon">üìñ</div><div class="label">–Ü—Å—Ç–æ—Ä—ñ—è</div></button>
  </div>


  <div id="clear-history-container">
    <h1 id="entry-heading" onclick="clearEntries()">
      –û—á–∏—Å—Ç–∏—Ç–∏ —ñ—Å—Ç–æ—Ä—ñ—é
    </h1>
  </div>


  <div id="empty-message" style="
    display: none;
    text-align: center;
    margin-top: 100px;
    font-size: 20px;
    color: #666;
    font-style: italic;
    user-select: none;
  ">
    –Ü—Å—Ç–æ—Ä—ñ—è –∑–∞–ø–∏—Å—ñ–≤ –ø–æ—Ä–æ–∂–Ω—è.
  </div>

  <div id="entries-container"></div>


    <ul id="log"></ul>
    <div id="toast" class="toast"></div>

    <script>
    function showEntries() {
    const container = document.getElementById('entries-container');
    const message = document.getElementById('empty-message');
    const clearButtonContainer = document.getElementById('clear-history-container');
    container.innerHTML = '';

    const log = JSON.parse(localStorage.getItem('moodLog') || '[]');

    if (log.length === 0) {
      message.style.display = 'block';
      if (clearButtonContainer) clearButtonContainer.style.display = 'none';
      return;
    } else {
      message.style.display = 'none';
      if (clearButtonContainer) clearButtonContainer.style.display = 'block';
    }

    log.forEach((entry, dayIndex) => {

      const entryDiv = document.createElement('div');
      entryDiv.style.marginBottom = '20px';
      entryDiv.style.borderLeft = '5px solid #aaa';
      entryDiv.style.paddingLeft = '10px';

      const dateEl = document.createElement('div');
      dateEl.textContent = `–ù–∞—á—ñ—Ä–∫–∞–≤: ${entry.date}`;
      dateEl.style.fontWeight = 'bold';
      dateEl.style.marginBottom = '6px';
      entryDiv.appendChild(dateEl);
      

      const list = document.createElement('ul');
      list.style.listStyle = 'none';
      list.style.padding = '0';

      entry.responses.forEach((response, responseIndex) => {

    const item = document.createElement('li');

// –°—Ç–≤–æ—Ä—é—î–º–æ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä –¥–ª—è —Ç–µ–∫—Å—Ç—É –π –∫–Ω–æ–ø–∫–∏
item.innerHTML = `
  <span class="entry-text">${response.text} ${response.emoji || ''}</span>
  <button class="delete-btn" title="–í–∏–¥–∞–ª–∏—Ç–∏ –∑–∞–ø–∏—Å">‚ùå</button>
`;

const deleteBtn = item.querySelector('.delete-btn');
deleteBtn.onclick = () => deleteSingleResponse(dayIndex, responseIndex);

list.appendChild(item);
    });


      entryDiv.appendChild(list);
      container.appendChild(entryDiv);
    });
  }




      function deleteEntry(index) {
        const log = JSON.parse(localStorage.getItem('moodLog') || '[]');
        if (confirm("–í–∏–¥–∞–ª–∏—Ç–∏ —Ü–µ–π –∑–∞–ø–∏—Å?")) {
          log.splice(index, 1);
          localStorage.setItem('moodLog', JSON.stringify(log));
          showEntries();
        }
      }

    function deleteSingleResponse(dayIndex, responseIndex) {
    const log = JSON.parse(localStorage.getItem('moodLog') || '[]');

    if (!log[dayIndex] || !log[dayIndex].responses[responseIndex]) return;

    const toast = document.getElementById('undo-toast');
    toast.innerHTML = `
      <span>–í–∏ –≤–ø–µ–≤–Ω–µ–Ω—ñ, —â–æ —Ö–æ—á–µ—Ç–µ –≤–∏–¥–∞–ª–∏—Ç–∏ –∑–∞–ø–∏—Å?</span>
      <button id="confirm-delete-btn" style="
        margin-left: 12px;
        padding: 6px 14px;
        background: crimson;
        color: white;
        border: none;
        border-radius: 6px;
        cursor: pointer;
      ">–í–∏–¥–∞–ª–∏—Ç–∏</button>
    `;

    toast.style.display = 'flex';
    toast.style.opacity = '1';
    toast.style.transform = 'translateX(-50%) scale(1)';

    const confirmBtn = document.getElementById('confirm-delete-btn');
    confirmBtn.onclick = () => {
      log[dayIndex].responses.splice(responseIndex, 1);

      if (log[dayIndex].responses.length === 0) {
        log.splice(dayIndex, 1);
      }

      localStorage.setItem('moodLog', JSON.stringify(log));
      showEntries();
      hideUndoToast();
      showToast("–ó–∞–ø–∏—Å –≤–∏–¥–∞–ª–µ–Ω–æ.");
    };

    clearTimeout(undoTimeout);
    undoTimeout = setTimeout(() => {
      hideUndoToast();
    }, 8000);
  }


      showEntries();


  let undoTimeout;
  let backupLog = null;

  function clearEntries() {
    const log = JSON.parse(localStorage.getItem('moodLog') || '[]');
    if (log.length === 0) {
      showToast("–ù–µ–º–∞—î –∑–∞–ø–∏—Å—ñ–≤ –¥–ª—è –≤–∏–¥–∞–ª–µ–Ω–Ω—è.");
      return;
    }

    backupLog = log;

    const toast = document.getElementById('undo-toast');
    toast.innerHTML = `
    <span>–í–∏ –≤–ø–µ–≤–Ω–µ–Ω—ñ, —â–æ —Ö–æ—á–µ—Ç–µ –æ—á–∏—Å—Ç–∏—Ç–∏ —ñ—Å—Ç–æ—Ä—ñ—é?</span>
    <button id="confirm-clear-btn" style="border: 2px solid var(--bg-saveanconfirm); padding: 8px 4px; border-radius: 6px; cursor: pointer; font-weight: 600; margin-left: 12px;">
      –ü—ñ–¥—Ç–≤–µ—Ä–¥–∏—Ç–∏
    </button>
  `;

    toast.style.display = 'flex';
    toast.style.opacity = '1';
    toast.style.transform = 'translateX(-50%) scale(1)';

    const confirmBtn = document.getElementById('confirm-clear-btn');
    confirmBtn.addEventListener('click', () => {
      localStorage.removeItem('moodLog');
      showEntries();
      hideUndoToast();
      showToast("–£—Å—ñ –∑–∞–ø–∏—Å–∏ –≤–∏–¥–∞–ª–µ–Ω–æ.");
      clearTimeout(undoTimeout);  // –í–ø–µ–≤–Ω–∏—Ç–∏—Å—è, —â–æ —Ç–∞–π–º–µ—Ä –æ—á–∏—â–µ–Ω–∏–π
    });

    // –Ø–∫—â–æ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á –Ω–µ –Ω–∞—Ç–∏—Å–Ω–µ "–ü—ñ–¥—Ç–≤–µ—Ä–¥–∏—Ç–∏", –ø—Ä–∏—Ö–æ–≤–∞—Ç–∏ toast —á–µ—Ä–µ–∑ 8 —Å–µ–∫
    undoTimeout = setTimeout(() => {
      hideUndoToast();
    }, 8000);
  }

  function showToast(message, duration = 3000) {
  const toast = document.getElementById('toast');
  toast.textContent = message;
  toast.classList.add('show');

  setTimeout(() => {
    toast.classList.remove('show');
  }, duration);
}

  function hideUndoToast() {
    const toast = document.getElementById('undo-toast');
    toast.style.opacity = '0';
    toast.style.transform = 'translateX(-50%) scale(0.9)';
    setTimeout(() => {
      toast.style.display = 'none';
      toast.innerHTML = '';
    }, 300);
  }

    </script>

    <script defer src="serviceWorker.js"></script>
    <script src="allfiles.js" defer></script>
  </body>
  </html>
